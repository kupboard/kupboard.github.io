(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8859],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return d},kt:function(){return k}});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function u(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var o=r.createContext({}),s=function(e){var t=r.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=s(e.components);return r.createElement(o.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,o=e.parentName,d=u(e,["components","mdxType","originalType","parentName"]),c=s(a),k=n,m=c["".concat(o,".").concat(k)]||c[k]||p[k]||l;return a?r.createElement(m,i(i({ref:t},d),{},{components:a})):r.createElement(m,i({ref:t},d))}));function k(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,i=new Array(l);i[0]=c;var u={};for(var o in t)hasOwnProperty.call(t,o)&&(u[o]=t[o]);u.originalType=e,u.mdxType="string"==typeof e?e:n,i[1]=u;for(var s=2;s<l;s++)i[s]=a[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}c.displayName="MDXCreateElement"},8002:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return i},metadata:function(){return u},toc:function(){return o},default:function(){return d}});var r=a(2122),n=a(9756),l=(a(7294),a(3905)),i={},u={unversionedId:"getstarted/azure",id:"getstarted/azure",isDocsHomePage:!1,title:"AZure",description:"Set up Kupboard clusters",source:"@site/docs/getstarted/azure.md",sourceDirName:"getstarted",slug:"/getstarted/azure",permalink:"/docs/getstarted/azure",editUrl:"https://github.com/kupboard/kupboard-docs/edit/main/docs/getstarted/azure.md",version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Google Cloud Platform",permalink:"/docs/getstarted/gcp"},next:{title:"Alibaba Cloud",permalink:"/docs/getstarted/alibaba"}},o=[{value:"Set up Kupboard clusters",id:"set-up-kupboard-clusters",children:[]},{value:"Introduction",id:"introduction",children:[]},{value:"Virtual Machine Instance",id:"virtual-machine-instance",children:[]},{value:"Firewall",id:"firewall",children:[]},{value:"SSH Key",id:"ssh-key",children:[]},{value:"Server Configuration Result",id:"server-configuration-result",children:[{value:"Virtual machines",id:"virtual-machines",children:[]},{value:"SSH public key",id:"ssh-public-key",children:[]},{value:"Port Rules",id:"port-rules",children:[]},{value:"Virtual Network",id:"virtual-network",children:[]}]},{value:"Data",id:"data",children:[]}],s={toc:o};function d(e){var t=e.components,i=(0,n.Z)(e,["components"]);return(0,l.kt)("wrapper",(0,r.Z)({},s,i,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h3",{id:"set-up-kupboard-clusters"},"Set up Kupboard clusters"),(0,l.kt)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/dolaPYAuT2A",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0}),(0,l.kt)("h2",{id:"introduction"},"Introduction"),(0,l.kt)("p",null,"This section describes how to create and configure Virtual Machine instances to build a kupboard cluster on AZure."),(0,l.kt)("h2",{id:"virtual-machine-instance"},"Virtual Machine Instance"),(0,l.kt)("p",null,"Kupboard clusters can be configured in a variety of ways depending on the service and application. In this example, we will create 1 server for the admin cluster, 1 server for the gateway cluster, and 4 servers for the service cluster."),(0,l.kt)("p",null,"You need to create six Virtual Machine instances as in the table below. OS for all instances must be Ubuntu18.04 or 20.04. The size of additional disks should change depending on services or packages installed on the service cluster"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Cluster"),(0,l.kt)("th",{parentName:"tr",align:null},"Instance Type"),(0,l.kt)("th",{parentName:"tr",align:null},"Quantity"),(0,l.kt)("th",{parentName:"tr",align:null},"Boot Disk"),(0,l.kt)("th",{parentName:"tr",align:null},"Additional Disk"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Admin"),(0,l.kt)("td",{parentName:"tr",align:null},"B2s <"),(0,l.kt)("td",{parentName:"tr",align:null},"1"),(0,l.kt)("td",{parentName:"tr",align:null},"50GB"),(0,l.kt)("td",{parentName:"tr",align:null},"N/A")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Gateway"),(0,l.kt)("td",{parentName:"tr",align:null},"B2s <"),(0,l.kt)("td",{parentName:"tr",align:null},"1"),(0,l.kt)("td",{parentName:"tr",align:null},"50GB"),(0,l.kt)("td",{parentName:"tr",align:null},"N/A")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Service"),(0,l.kt)("td",{parentName:"tr",align:null},"B2ms <"),(0,l.kt)("td",{parentName:"tr",align:null},"4"),(0,l.kt)("td",{parentName:"tr",align:null},"50GB"),(0,l.kt)("td",{parentName:"tr",align:null},"50GB <")))),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"B2s")," 2 vCPUs, 4G RAM ",(0,l.kt)("br",null),"\n",(0,l.kt)("inlineCode",{parentName:"p"},"B2ms")," 2 vCPUs, 8G RAM"),(0,l.kt)("h2",{id:"firewall"},"Firewall"),(0,l.kt)("p",null,"Create a firewall for a subnet."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Cluster"),(0,l.kt)("th",{parentName:"tr",align:null},"Inbound"),(0,l.kt)("th",{parentName:"tr",align:null},"Source"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"All"),(0,l.kt)("td",{parentName:"tr",align:null},"22"),(0,l.kt)("td",{parentName:"tr",align:null},"0.0.0.0/0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"1 - 65535"),(0,l.kt)("td",{parentName:"tr",align:null},"Subnet")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Admin"),(0,l.kt)("td",{parentName:"tr",align:null},"80,443"),(0,l.kt)("td",{parentName:"tr",align:null},"0.0.0.0/0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Gateway"),(0,l.kt)("td",{parentName:"tr",align:null},"80,443"),(0,l.kt)("td",{parentName:"tr",align:null},"0.0.0.0/0")))),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Cluster"),(0,l.kt)("th",{parentName:"tr",align:null},"Outbound"),(0,l.kt)("th",{parentName:"tr",align:null},"Destination"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"All"),(0,l.kt)("td",{parentName:"tr",align:null},"1 - 65535"),(0,l.kt)("td",{parentName:"tr",align:null},"0.0.0.0/0")))),(0,l.kt)("h2",{id:"ssh-key"},"SSH Key"),(0,l.kt)("p",null,"In order to set up the servers, you need a SSH key pair to enable automatic ",(0,l.kt)("inlineCode",{parentName:"p"},"azureuser")," account login to the individual server. AZure provides the ",(0,l.kt)("inlineCode",{parentName:"p"},"SSH public key")," service whereby a new SSH key pair is generated. The private key is downloaded into the local PC. The public key is mapped into a server as it is created."),(0,l.kt)("p",null,"The downloaded private key is moved into the local PC\u2019s ",(0,l.kt)("inlineCode",{parentName:"p"},"data/certs"),". It should be renamed to ",(0,l.kt)("inlineCode",{parentName:"p"},"ssh.pem"),". You can log into the server like below."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"$ ssh -i ssh.pem azureuser@<server-ip>\n")),(0,l.kt)("p",null,"At the user initialization stage of kupboard setup, the ",(0,l.kt)("inlineCode",{parentName:"p"},"azureuser")," account login is automatically done."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"$ kupboard setup --init-user --root-username azureuser\n")),(0,l.kt)("h2",{id:"server-configuration-result"},"Server Configuration Result"),(0,l.kt)("h3",{id:"virtual-machines"},"Virtual machines"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},(0,l.kt)("img",{alt:"ncloud-install-01",src:a(5270).Z}))))),(0,l.kt)("h3",{id:"ssh-public-key"},"SSH public key"),(0,l.kt)("p",null,"As the first Virtual Machine instance is created, a new SSK key pair must be generated. The next Virtual Machine servers should use the SSK public key created by the first instance."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},(0,l.kt)("img",{alt:"ncloud-install-02",src:a(9736).Z}))))),(0,l.kt)("h3",{id:"port-rules"},"Port Rules"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},(0,l.kt)("img",{alt:"ncloud-install-02",src:a(6319).Z}))))),(0,l.kt)("h3",{id:"virtual-network"},"Virtual Network"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},(0,l.kt)("img",{alt:"kcloud-select-ssh-keypair",src:a(2060).Z}))))),(0,l.kt)("h2",{id:"data"},"Data"),(0,l.kt)("p",null,"Move to ",(0,l.kt)("a",{parentName:"p",href:"/docs/getstarted/data"},"Data")))}d.isMDXComponent=!0},6319:function(e,t,a){"use strict";t.Z=a.p+"assets/images/azure-port-rule-72e4b9988e9d6505a8a3cf44e9cc4e89.png"},9736:function(e,t,a){"use strict";t.Z=a.p+"assets/images/azure-ssh-public-key-5e8a4dc25ef63198f621b068b5e5ba50.png"},5270:function(e,t,a){"use strict";t.Z=a.p+"assets/images/azure-virtual-machine-ed9963690254ae45d68d30fd7d9d758d.png"},2060:function(e,t,a){"use strict";t.Z=a.p+"assets/images/azure-virtual-network-13b26fd38ce484dd2905d0c9cc0d25e9.png"}}]);