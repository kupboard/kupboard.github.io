(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3266],{3905:function(e,a,n){"use strict";n.d(a,{Zo:function(){return s},kt:function(){return d}});var t=n(7294);function o(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function r(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?r(Object(n),!0).forEach((function(a){o(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function l(e,a){if(null==e)return{};var n,t,o=function(e,a){if(null==e)return{};var n,t,o={},r=Object.keys(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||(o[n]=e[n]);return o}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=t.createContext({}),p=function(e){var a=t.useContext(c),n=a;return e&&(n="function"==typeof e?e(a):i(i({},a),e)),n},s=function(e){var a=p(e.components);return t.createElement(c.Provider,{value:a},e.children)},u={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},k=t.forwardRef((function(e,a){var n=e.components,o=e.mdxType,r=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),k=p(n),d=o,m=k["".concat(c,".").concat(d)]||k[d]||u[d]||r;return n?t.createElement(m,i(i({ref:a},s),{},{components:n})):t.createElement(m,i({ref:a},s))}));function d(e,a){var n=arguments,o=a&&a.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=k;var l={};for(var c in a)hasOwnProperty.call(a,c)&&(l[c]=a[c]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var p=2;p<r;p++)i[p]=n[p];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}k.displayName="MDXCreateElement"},6504:function(e,a,n){"use strict";n.r(a),n.d(a,{frontMatter:function(){return i},metadata:function(){return l},toc:function(){return c},default:function(){return s}});var t=n(2122),o=n(9756),r=(n(7294),n(3905)),i={},l={unversionedId:"collection/package",id:"collection/package",isDocsHomePage:!1,title:"Package",description:"The collection package of the kupboard uses Ansible Playbook. Ansible is a greate open source tool and is already used widely for a variety of purposes in many solutions. There are many good written playbooks on the Internet. You can use those playbooks very easily and quickly by defining only the action in the config. In the kupboard, we tried to avoid the functional limitations of creating a package's playbook. Users can also use playbooks and actions to create their own great collections.",source:"@site/docs/collection/package.md",sourceDirName:"collection",slug:"/collection/package",permalink:"/docs/collection/package",editUrl:"https://github.com/kupboard/kupboard-docs/edit/main/docs/collection/package.md",version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Application",permalink:"/docs/collection/application"},next:{title:"ArgoCD",permalink:"/docs/collection/packages/argocd"}},c=[{value:"kupboard-collection-nginx",id:"kupboard-collection-nginx",children:[]},{value:"Default Packages",id:"default-packages",children:[]}],p={toc:c};function s(e){var a=e.components,n=(0,o.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,t.Z)({},p,n,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The collection package of the kupboard uses Ansible Playbook. Ansible is a greate open source tool and is already used widely for a variety of purposes in many solutions. There are many good written playbooks on the Internet. You can use those playbooks very easily and quickly by defining only the ",(0,r.kt)("inlineCode",{parentName:"p"},"action")," in the config. In the kupboard, we tried to avoid the functional limitations of creating a package's playbook. Users can also use playbooks and actions to create their own great collections."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mycollection\n\u2514\u2500\u2500 packages\n    \u251c\u2500\u2500 package1\n    \u2502\xa0\xa0 \u2514\u2500\u2500 playbook.yaml\n    \u2514\u2500\u2500 package2\n        \u251c\u2500\u2500 data    \n        \u2514\u2500\u2500 playbook.yaml\n")),(0,r.kt)("p",null,"This is an example to run a collection command. The ",(0,r.kt)("inlineCode",{parentName:"p"},"-c <collection-name>")," option allow you to use packages in a specific collection."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"$ kupboard collection package -n <package-name> [-a <action-name>]\n")),(0,r.kt)("h2",{id:"kupboard-collection-nginx"},"kupboard-collection-nginx"),(0,r.kt)("p",null,"Let's check an example ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mike-atop/kupboard-materials/raw/main/collections/kupboard-collection-nginx.tar.gz"},"kupboard-collection-nginx"),"."),(0,r.kt)("p",null,"In ",(0,r.kt)("inlineCode",{parentName:"p"},"config.yaml")," a pakcage named ",(0,r.kt)("inlineCode",{parentName:"p"},"nginx")," is defined and there are two actions, ",(0,r.kt)("inlineCode",{parentName:"p"},"deploy")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"delete"),". Only one playbook named ",(0,r.kt)("inlineCode",{parentName:"p"},"nginx.yaml")," is used and the variable ",(0,r.kt)("inlineCode",{parentName:"p"},"target_group")," can be used in the playbook. And the variable ",(0,r.kt)("inlineCode",{parentName:"p"},"state")," is used when actions are excuted, and its value can be ",(0,r.kt)("inlineCode",{parentName:"p"},"started")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"absent"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"version: 1.0\nmetadata:\n  name: Nginx\npackages:\n  - name: nginx\n    playbook: nginx/nginx.yaml\n    vars:\n      target_group: gateway\n    actions:\n      - name: deploy\n        default: true\n        vars:\n          state: started\n        params:\n      - name: delete\n        vars:\n          state: absent\n        params:\n")),(0,r.kt)("p",null,"The Nginx package uses the 'nginx:1.19.10' container. It uses ",(0,r.kt)("inlineCode",{parentName:"p"},"target_group")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"state")," defined in the config, and the ",(0,r.kt)("inlineCode",{parentName:"p"},"state")," value is used for container deployment. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'- name: Nginx Package\n  hosts: "{{ target_group }}"\n  become: no\n  vars:\n    release_state: "{{ state | default(\'started\') }}"\n  tasks: \n  - name: "{% if release_state == \'started\' %} Deploy Nginx {% else %} Remove Nginx {% endif %}"\n    docker_container:\n      name: nginx\n      image: nginx:1.19.10\n      state: "{{ release_state }}"\n      restart_policy: always\n      container_default_behavior: compatibility\n      restart: yes\n      ports:\n        - 80:80\n')),(0,r.kt)("p",null,"Now you can see that you need to use the ",(0,r.kt)("inlineCode",{parentName:"p"},"-a deploy")," option to install nginx in the gateway cluster when using Nginx Package, and you can delete nginx installed in the gateway cluster with the ",(0,r.kt)("inlineCode",{parentName:"p"},"-a delete")," option."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"$ kupboard collection package -c kupboard-collection-nginx -n nginx -a <deploy|delete>\n")),(0,r.kt)("h2",{id:"default-packages"},"Default Packages"),(0,r.kt)("p",null,"The default collection of kupboard includes many packages for various open source."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/argocd"},"argocd")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/dashboard"},"dashboard")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/elastic"},"elastic")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/fluentd"},"fluentd")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/harbor"},"harbor")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/influxdb"},"influxdb")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/istio"},"istio")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/kafka"},"kafka")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/keycloak"},"keycloak")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/minio"},"minio")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/mongodb"},"mongodb")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/mysql"},"mysql")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/nginx"},"nginx")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/prometheus"},"prometheus")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"packages/redis"},"redis"))))}s.isMDXComponent=!0}}]);